<% if (@locations) %>
  <% @locations.each do |l| %>
  <table>
    <tr>
      <td><%= image_tag('closed_arrow.gif') %></td>
      <td>
        <%= link_to('#', :id => 'show_location_detail_' + l.id.to_s, :onclick => 'showLocation(' + l.id.to_s + ',' + l.lat.to_s + ',' +  l.lon.to_s + ');') do %>
          <span><%= [l.name, l.street, l.city].join(' | ') %></span><span id="machine_summary_<%= l.id %>"> # <%= [l.machine_names].join(' | ') %></span>
        <% end %>
      </td>
    </tr>
  </table>
  <table id="location_detail_<%= l.id %>" style="display: none;">
    <tr>
      <td>Add Machine</td>
    </tr>
    <tr>
      <td><%= render :partial => 'locations/add_machine', :locals => {:location_id => l.id} %></td>
    </tr>
    <% LocationMachineXref.find_all_by_location_id(l.id).collect! do |lmx| %>
    <tr>
      <td><%= render :partial => 'locations/show_machine', :locals => {:lmx => lmx} %></td>
    </tr>
    <% end %>
  </table>
  <% end %>
<% end %>
