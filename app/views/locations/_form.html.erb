<%= form_tag locations_path, :method => 'get', :id => 'location_search', :remote => true do %>
  <%= label_tag :by_city, 'By City' %>
  <%= select_tag :by_city, options_for_select(['']) + options_from_collection_for_select(Location.find(:all, :conditions => ['region_id = ?', @region.id], :select => 'distinct city'), 'city', 'city', params[:by_city]) %>
  <br clear="all" />
  <%= label_tag :by_zone_id, 'By Zone' %>
  <%= select_tag :by_zone_id, options_for_select(['']) + options_from_collection_for_select(Zone.where('region_id = ?', @region.id), 'id', 'name', params[:by_zone_id]) %>
  <br clear="all" />
  <%= label_tag :by_location_name, 'Location Name' %>
  <%= text_field_tag :by_location_name, params[:by_location_name] %>
  <%= select_tag :by_location_id, options_for_select(['']) + options_from_collection_for_select(Location.where('region_id = ?', @region.id), 'id', 'name', params[:by_location_id]) %>
  <br clear="all" />
  <%= label_tag :by_machine_name, 'Machine Name' %>
  <%= text_field_tag :by_machine_name, params[:by_machine_name] %>
  <%= select_tag :by_machine_id, options_for_select(['']) + options_from_collection_for_select(Machine.all, 'id', 'name', params[:by_machine_id]) %>
  <br clear="all" />
  <%= submit_tag 'Search' %>
<% end %>

<script type="text/javascript">
  $(function () {
    $('#by_location_name').autocomplete({source: '<%= autocomplete_locations_path %>'});
    $('#by_machine_name').autocomplete({source: '<%= autocomplete_machines_path %>'});
  });
</script>
